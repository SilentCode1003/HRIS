<script>
    let map;

    $(document).ready(function () {
        searchTable();

        $(document).on('keyup', '#myInput', function () {
            searchTable();
        });

         // Initialize the map
    function initMap() {
        map = L.map('map').setView([0, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // Add a marker to the map
        const marker = L.marker([0, 0]).addTo(map);

        // Listen for map click events
        map.on('click', function (e) {
            const { lat, lng } = e.latlng;
            marker.setLatLng([lat, lng]);
            $('#latitude').val(lat.toFixed(6));
            $('#longitude').val(lng.toFixed(6));
        });
    }

    // Call initMap on modal show
    $('#geoFenceModal').on('shown.bs.modal', function () {
        initMap();
    });

    function setGeoFence() {
        const latitude = $('#latitude').val();
        const longitude = $('#longitude').val();
        const radius = $('#radius').val();

        // Make an AJAX request to the server
        $.ajax({
            type: 'POST',
            url: `/attendance/set-geofence?geofenceLatitude=${latitude}&geofenceLongitude=${longitude}&geofenceRadius=${radius}`,
            contentType: 'application/json',
            success: function (data) {
                console.log(data.message);
                // Handle success or show a message to the user
                $('#geoFenceModal').modal('hide'); // Close the modal
            },
            error: function (error) {
                console.error('Error:', error);
                // Handle errors or show an error message to the user
            }
        });
    }

    });
    // function searchTable() {
    //     var input, filter, found, table, tr, td, i, j;
    //     input = document.getElementById("myInput");
    //     filter = input.value.toUpperCase();
    //     table = document.getElementById("dataTableattendance");
    //     tr = table.getElementsByTagName("tr");
    //     for (i = 0; i < tr.length; i++) {
    //         td = tr[i].getElementsByTagName("td");
    //         for (j = 0; j < td.length; j++) {
    //             if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
    //                 found = true;
    //             }
    //         }
    //         if (found) {
    //             tr[i].style.display = "";
    //             found = false;
    //         } else {
    //             tr[i].style.display = "none";
    //         }
    //     }
    // }
</script>